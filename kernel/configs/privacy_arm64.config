# ShadowOS ARM64 Kernel Configuration
# kernel/configs/privacy_arm64.config
#
# Privacy-hardened kernel config for ARM64 (aarch64)
# Merge with: scripts/kconfig/merge_config.sh arch/arm64/configs/defconfig privacy_arm64.config
#

# =============================================================================
# ARM64 SPECIFIC
# =============================================================================

CONFIG_ARM64=y
CONFIG_64BIT=y
CONFIG_ARM64_VA_BITS_48=y
CONFIG_ARM64_4K_PAGES=y

# Pointer authentication
CONFIG_ARM64_PTR_AUTH=y
CONFIG_ARM64_PTR_AUTH_KERNEL=y

# Branch Target Identification
CONFIG_ARM64_BTI=y
CONFIG_ARM64_BTI_KERNEL=y

# Memory Tagging Extension
CONFIG_ARM64_MTE=y

# Crypto acceleration
CONFIG_ARM64_CRYPTO=y
CONFIG_CRYPTO_SHA1_ARM64_CE=y
CONFIG_CRYPTO_SHA2_ARM64_CE=y
CONFIG_CRYPTO_SHA512_ARM64_CE=y
CONFIG_CRYPTO_SHA3_ARM64=y
CONFIG_CRYPTO_AES_ARM64_CE_CCM=y
CONFIG_CRYPTO_AES_ARM64_CE_BLK=y
CONFIG_CRYPTO_CHACHA20_NEON=y
CONFIG_CRYPTO_POLY1305_NEON=y

# =============================================================================
# SECURITY (same as x86)
# =============================================================================

# LSM Stack
CONFIG_SECURITY=y
CONFIG_SECURITYFS=y
CONFIG_SECURITY_NETWORK=y
CONFIG_LSM="landlock,lockdown,yama,loadpin,safesetid,integrity,apparmor"
CONFIG_DEFAULT_SECURITY_APPARMOR=y

# Memory hardening
CONFIG_STACKPROTECTOR=y
CONFIG_STACKPROTECTOR_STRONG=y
CONFIG_INIT_STACK_ALL_ZERO=y
CONFIG_INIT_ON_ALLOC_DEFAULT_ON=y
CONFIG_INIT_ON_FREE_DEFAULT_ON=y
CONFIG_HARDENED_USERCOPY=y
CONFIG_FORTIFY_SOURCE=y

# ASLR
CONFIG_RANDOMIZE_BASE=y
CONFIG_RANDOMIZE_MODULE_REGION_FULL=y

# Restrict info leaks
CONFIG_SECURITY_DMESG_RESTRICT=y

# Disable debug
# CONFIG_DEBUG_KERNEL is not set
# CONFIG_KPROBES is not set
# CONFIG_FTRACE is not set

# =============================================================================
# CRYPTO
# =============================================================================

CONFIG_CRYPTO=y
CONFIG_CRYPTO_ALGAPI=y
CONFIG_CRYPTO_AEAD=y
CONFIG_CRYPTO_BLKCIPHER=y
CONFIG_CRYPTO_AES=y
CONFIG_CRYPTO_XTS=y
CONFIG_CRYPTO_GCM=y
CONFIG_CRYPTO_CHACHA20POLY1305=y
CONFIG_CRYPTO_SHA512=y
CONFIG_CRYPTO_BLAKE2B=y
CONFIG_CRYPTO_DRBG=y
CONFIG_CRYPTO_USER_API=y
CONFIG_CRYPTO_USER_API_HASH=y
CONFIG_CRYPTO_USER_API_SKCIPHER=y
CONFIG_CRYPTO_USER_API_AEAD=y

# =============================================================================
# WIRELESS
# =============================================================================

CONFIG_WIRELESS=y
CONFIG_CFG80211=m
CONFIG_MAC80211=m
CONFIG_MAC80211_MESH=y
CONFIG_RFKILL=m

# Common ARM64 WiFi chipsets
CONFIG_WLAN_VENDOR_BROADCOM=y
CONFIG_BRCMFMAC=m
CONFIG_BRCMFMAC_SDIO=y
CONFIG_WLAN_VENDOR_REALTEK=y
CONFIG_RTW88=m
CONFIG_RTW89=m

# =============================================================================
# USB & STORAGE
# =============================================================================

CONFIG_USB=y
CONFIG_USB_XHCI_HCD=y
CONFIG_USB_STORAGE=m
CONFIG_USB_NET_DRIVERS=y

CONFIG_BLK_DEV_DM=y
CONFIG_DM_CRYPT=y
CONFIG_DM_VERITY=y

# =============================================================================
# FILESYSTEMS
# =============================================================================

CONFIG_EXT4_FS=y
CONFIG_EXT4_FS_SECURITY=y
CONFIG_BTRFS_FS=m
CONFIG_SQUASHFS=y
CONFIG_SQUASHFS_XZ=y
CONFIG_OVERLAY_FS=y
CONFIG_TMPFS=y
CONFIG_TMPFS_XATTR=y
CONFIG_FUSE_FS=m
CONFIG_VFAT_FS=m
CONFIG_EXFAT_FS=m

# =============================================================================
# NETWORKING
# =============================================================================

CONFIG_NET=y
CONFIG_INET=y
CONFIG_NETFILTER=y
CONFIG_NF_TABLES=m
CONFIG_WIREGUARD=m
CONFIG_TLS=y
CONFIG_XFRM_USER=m
